From 5c3924cf363842282587cb5314d09d283bc882a8 Mon Sep 17 00:00:00 2001
From: Robin Lee <robinlee.sysu@gmail.com>
Date: Wed, 18 Oct 2023 12:51:09 +0800
Subject: [PATCH 07/14] components/gmp.bst: Update to 6.3.0

---
 elements/components/gmp.bst                   |  9 ++-----
 ...z-inp_raw.c-Avoid-bit-size-overflows.patch | 25 -------------------
 2 files changed, 2 insertions(+), 32 deletions(-)
 delete mode 100644 patches/gmp/mpz-inp_raw.c-Avoid-bit-size-overflows.patch

diff --git a/elements/components/gmp.bst b/elements/components/gmp.bst
index 27b44b3cd..852020cf8 100644
--- a/elements/components/gmp.bst
+++ b/elements/components/gmp.bst
@@ -23,13 +23,8 @@ public:
         (>):
         - '%{libdir}/libgmp.so'
         - '%{libdir}/libgmpxx.so'
-  cpe:
-    patches:
-    - CVE-2021-43618
 
 sources:
 - kind: tar
-  url: ftp_gnu_org:gmp/gmp-6.2.1.tar.xz
-  ref: fd4829912cddd12f84181c3451cc752be224643e87fac497b69edddadc49b4f2
-- kind: patch
-  path: patches/gmp/mpz-inp_raw.c-Avoid-bit-size-overflows.patch
+  url: ftp_gnu_org:gmp/gmp-6.3.0.tar.xz
+  ref: a3c2b80201b89e68616f4ad30bc66aee4927c3ce50e33929ca819d5c43538898
diff --git a/patches/gmp/mpz-inp_raw.c-Avoid-bit-size-overflows.patch b/patches/gmp/mpz-inp_raw.c-Avoid-bit-size-overflows.patch
deleted file mode 100644
index f74197243..000000000
--- a/patches/gmp/mpz-inp_raw.c-Avoid-bit-size-overflows.patch
+++ /dev/null
@@ -1,25 +0,0 @@
-
-# HG changeset patch
-# User Marco Bodrato <bodrato@mail.dm.unipi.it>
-# Date 1634836009 -7200
-# Node ID 561a9c25298e17bb01896801ff353546c6923dbd
-# Parent  e1fd9db13b475209a864577237ea4b9105b3e96e
-mpz/inp_raw.c: Avoid bit size overflows
-
-diff -r e1fd9db13b47 -r 561a9c25298e mpz/inp_raw.c
---- a/mpz/inp_raw.c	Tue Dec 22 23:49:51 2020 +0100
-+++ b/mpz/inp_raw.c	Thu Oct 21 19:06:49 2021 +0200
-@@ -88,8 +88,11 @@
- 
-   abs_csize = ABS (csize);
- 
-+  if (UNLIKELY (abs_csize > ~(mp_bitcnt_t) 0 / 8))
-+    return 0; /* Bit size overflows */
-+
-   /* round up to a multiple of limbs */
--  abs_xsize = BITS_TO_LIMBS (abs_csize*8);
-+  abs_xsize = BITS_TO_LIMBS ((mp_bitcnt_t) abs_csize * 8);
- 
-   if (abs_xsize != 0)
-     {
-
-- 
2.41.0

