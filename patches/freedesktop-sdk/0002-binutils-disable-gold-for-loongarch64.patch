From 39bc8e19481abcc7bc02c2c6d4a3daccb0d518a7 Mon Sep 17 00:00:00 2001
From: Robin Lee <robinlee.sysu@gmail.com>
Date: Sat, 4 Feb 2023 13:54:46 +0800
Subject: [PATCH 02/14] binutils: disable gold for loongarch64

---
 elements/bootstrap/binutils.bst | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/elements/bootstrap/binutils.bst b/elements/bootstrap/binutils.bst
index d845297a6..0a9837850 100644
--- a/elements/bootstrap/binutils.bst
+++ b/elements/bootstrap/binutils.bst
@@ -18,11 +18,15 @@ variables:
   # https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/jobs/110741993
   # FIXME: what happens when we make it depend on gcc.bst? Does it it fix it?
   target_flags_exceptions: ''
+  gold-option: "--enable-gold"
+  (?):
+  - target_arch == "loongarch64":
+      gold-option: "--disable-gold"
   conf-local: >-
     CFLAGS="${CFLAGS}"
     --disable-werror
     --with-lib-path="%{libdir}:%{indep-libdir}"
-    --enable-gold
+    %{gold-option}
     --enable-ld=default
     --enable-shared
     --enable-plugins
-- 
2.41.0

